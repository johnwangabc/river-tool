# Expo Go 卡住问题已修复

## 问题原因

项目配置中错误地使用了 `expo-router`，但我们实际使用的是传统的 React Navigation。这导致Expo Go加载时卡在默认的路由页面。

## 已修复内容

### 1. 更新 package.json
- ✅ 将入口从 `expo-router/entry` 改为 `node_modules/expo/AppEntry.js`
- ✅ 移除 `expo-router` 依赖
- ✅ 移除 `expo-asset` 依赖

### 2. 更新 app.json
- ✅ 移除 `expo-router` 插件配置
- ✅ 移除 `router` 配置项

### 3. 更新 babel.config.js
- ✅ 移除 `expo-router/babel` 插件

### 4. 清理文件
- ✅ 删除 `app/` 目录（expo-router创建的）
- ✅ 删除 `index.js`（expo-router入口）
- ✅ 清理node_modules并重新安装

## 现在如何启动

### 方法1: 使用脚本（推荐）
```bash
双击运行 start.bat
```

### 方法2: 使用命令行
```bash
# 清理缓存（如果还有问题）
npx expo start -c

# 或正常启动
npm start
```

## 验证步骤

1. 启动后应该看到：
   ```
   › Metro waiting on exp://...
   › Scan the QR code above with Expo Go (Android) or the Camera app (iOS)
   ```

2. 用Expo Go扫码后应该：
   - 看到加载进度条
   - 显示应用的4个标签页：活动统计、巡护评测、综合统计、设置
   - 能够正常切换标签

## 如果仍有问题

### 完全重置
```bash
# 1. 停止当前的Metro服务器（Ctrl+C）

# 2. 清理所有缓存
rm -rf node_modules
rm -rf .expo
rm package-lock.json

# 3. 重新安装
npm install

# 4. 清理启动
npx expo start -c
```

### 检查列表
- [ ] package.json 中 main 是 `node_modules/expo/AppEntry.js`
- [ ] app.json 中没有 expo-router 配置
- [ ] babel.config.js 只有 `babel-preset-expo`
- [ ] 不存在 `app/` 目录
- [ ] 不存在 `index.js` 文件
- [ ] App.js 存在且包含完整的导航代码

## 应用结构说明

现在的入口流程：
```
Expo启动
  ↓
加载 node_modules/expo/AppEntry.js
  ↓
注册 App.js 作为根组件
  ↓
App.js 初始化 React Navigation
  ↓
显示4个标签页面
```

## 测试建议

1. **首次启动**：进入"设置"标签，配置Token
2. **测试活动统计**：输入日期，点击"开始统计"
3. **测试巡护评测**：选择类型，输入日期，点击"开始爬取"
4. **测试综合统计**：输入日期，点击"开始统计"（需要较长时间）

## 已知正常行为

- 首次加载需要30秒左右（下载JavaScript bundle）
- 后续加载会快很多（有缓存）
- 开发模式下可以摇晃手机打开调试菜单
- 代码更改会自动热重载

---

**修复状态**: ✅ 完成
**测试状态**: 等待用户验证
**下一步**: 运行 `npm start` 或 `start.bat` 并用Expo Go扫码测试
