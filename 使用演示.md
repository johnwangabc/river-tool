# 使用演示指南

## 第一步：安装和启动

### 方法A: 使用便捷脚本 (推荐)

1. **安装依赖**
   ```
   双击运行: install.bat
   等待安装完成 (约2-3分钟)
   ```

2. **启动开发服务器**
   ```
   双击运行: start.bat
   终端会显示二维码
   ```

3. **在手机上查看**
   - 在手机上安装"Expo Go"应用
   - 打开Expo Go，扫描二维码
   - 等待应用加载 (首次约30秒)

### 方法B: 使用命令行

```bash
# 1. 安装依赖
npm install

# 2. 启动
npm start

# 3. 按提示扫码
```

---

## 第二步：配置Token

### 获取Token步骤

1. **打开浏览器** (Chrome/Edge推荐)
   访问: https://xhbr.rwan.org.cn

2. **登录系统**
   使用您的账号登录

3. **打开开发者工具**
   按F12键

4. **切换到Network标签**
   点击"Network"或"网络"

5. **刷新页面或执行任何操作**
   触发一些API请求

6. **找到请求**
   在请求列表中点击任意一个请求

7. **复制Token**
   - 在右侧找到"Request Headers"
   - 找到"Authorization"字段
   - 复制完整的值
   - 格式应该是: `Bearer eyJ0eXAiOiJKV1QiLCJhbGc...`

### 在应用中配置

1. **打开应用**
   在手机上打开已加载的应用

2. **进入设置页面**
   点击底部的"设置"标签

3. **粘贴Token**
   将复制的Token粘贴到"认证令牌"输入框

4. **保存**
   点击"保存设置"按钮

5. **确认**
   看到"成功"提示即表示保存成功

---

## 第三步：使用功能

### A. 活动数据统计

**场景**: 统计2025年1月1日以来的所有活动数据

1. **进入页面**
   点击底部"活动统计"标签

2. **输入日期**
   在"目标日期"框输入: `2025-01-01`

3. **开始统计**
   点击"开始统计"按钮

4. **等待加载**
   - 进度条会显示当前状态
   - 可以看到: "正在获取活动列表..."
   - 然后: "正在筛选活动..."
   - 最后: "获取活动详情 X/Y"

5. **查看结果**
   - 顶部显示统计摘要
   - 下方表格显示活动数据
   - 可以左右滑动查看更多列

6. **导出Excel**
   - 点击"导出Excel"按钮
   - 选择保存位置或分享方式
   - 文件名格式: `活动数据_2025-01-01_20250101_120000.xlsx`

---

### B. 河流巡护/评测数据

**场景**: 爬取最近30天的河流评测数据

1. **进入页面**
   点击底部"巡护评测"标签

2. **选择类型**
   - 点击"河流评测 (UseType=2)"
   - 或选择"河流巡护 (UseType=1)"

3. **输入日期**
   在"开始日期"框输入: `2025-01-01`

4. **开始爬取**
   点击"开始爬取"按钮

5. **观察进度**
   - 会显示: "正在获取第 X 页..."
   - 和: "第 X 页: Y 条符合条件"
   - 直到: "爬取完成，共 Z 条数据"

6. **查看统计**
   - 顶部显示: 总人数、总发帖数、平均值
   - 表格显示前50名用户

7. **导出Excel**
   - 点击"导出Excel"
   - 包含: 用户发帖统计、数据概览

---

### C. 综合次数统计

**场景**: 统计所有人的巡护、评测、活动参与总次数

1. **进入页面**
   点击底部"综合统计"标签

2. **输入日期**
   在"开始日期"框输入: `2025-01-01`

3. **开始统计**
   点击"开始统计"按钮

4. **耐心等待**
   - 这个功能需要较长时间
   - 会依次显示:
     - "正在获取河流巡护数据..."
     - "正在获取河流评测数据..."
     - "正在获取活动参与数据..."
     - "正在计算综合统计..."

5. **查看结果**
   - 表格显示: 姓名、巡护次数、评测次数、活动次数、总次数
   - 按总次数降序排列
   - 显示前20名

6. **导出Excel**
   - 点击"导出Excel"
   - 包含: 综合统计、统计摘要

---

## 实际使用示例

### 示例1: 月度活动统计

**需求**: 统计2025年1月的所有活动

**步骤**:
1. 活动统计 → 输入日期: `2025-01-01`
2. 开始统计
3. 等待完成
4. 查看统计摘要:
   - 活动总数: 35
   - 巡河活动: 20
   - 净滩活动: 15
   - 总参与: 450人
   - 平均参与: 12.86人
5. 导出Excel保存

### 示例2: 志愿者排行榜

**需求**: 统计本月参与次数最多的志愿者

**步骤**:
1. 综合统计 → 输入日期: `2025-01-01`
2. 开始统计
3. 等待3-5分钟
4. 查看结果表格:
   - 第1名: 张三 - 巡护15次、评测10次、活动8次、总计33次
   - 第2名: 李四 - 巡护12次、评测8次、活动10次、总计30次
   - ...
5. 导出Excel制作排行榜

### 示例3: 河流评测分析

**需求**: 分析近期河流评测情况

**步骤**:
1. 巡护评测 → 选择"河流评测"
2. 输入日期: `2025-01-01`
3. 开始爬取
4. 查看统计:
   - 总人数: 45人
   - 总发帖: 320条
   - 平均: 7.11条/人
5. 导出Excel查看详细数据

---

## 常见操作技巧

### 技巧1: 快速查看今日数据

```
输入今天的日期 (如: 2025-01-15)
可以只看今天的新增数据
```

### 技巧2: 批量导出数据

```
1. 活动统计 → 导出活动数据
2. 巡护评测 → 导出巡护数据
3. 巡护评测 → 切换类型 → 导出评测数据
4. 综合统计 → 导出综合数据
5. 得到4个Excel文件
```

### 技巧3: 数据对比

```
1. 第一次: 输入 2025-01-01，导出为"1月数据"
2. 第二次: 输入 2025-02-01，导出为"2月数据"
3. 在电脑上用Excel对比两个文件
```

### 技巧4: 表格查看

```
- 表格可以左右滑动查看更多列
- 只显示部分数据，完整数据在Excel中
- 数据按默认规则排序（时间或次数）
```

---

## 进度提示说明

### 活动统计进度

```
"正在获取活动列表 (预计 100 条)..."
  ↓
"正在筛选活动..."
  ↓
"找到 35 个活动，正在获取详情..."
  ↓
"获取活动详情 1/35"
"获取活动详情 2/35"
...
"获取活动详情 35/35"
  ↓
"数据加载完成"
```

### 巡护/评测进度

```
"正在爬取河流评测数据..."
  ↓
"正在获取第 1 页..."
"第 1 页: 10 条符合条件"
  ↓
"正在获取第 2 页..."
"第 2 页: 8 条符合条件"
  ↓
...
  ↓
"爬取完成，共 320 条数据"
```

### 综合统计进度

```
"开始综合统计..."
  ↓
"[巡护] 正在获取第 1 页..."
"[巡护] 第 1 页: 10 条符合条件"
...
"[巡护] 爬取完成，共 150 条数据"
  ↓
"[评测] 正在获取第 1 页..."
"[评测] 第 1 页: 10 条符合条件"
...
"[评测] 爬取完成，共 170 条数据"
  ↓
"[活动] 获取活动详情 1/35"
...
"[活动] 活动参与数据统计完成: 45人"
  ↓
"正在计算综合统计..."
  ↓
"综合统计完成"
```

---

## 错误处理

### 错误1: "请输入认证令牌"

**原因**: 未配置Token
**解决**: 进入设置页面，按第二步配置Token

### 错误2: "获取数据失败，请检查网络和Token设置"

**原因**: Token过期或网络问题
**解决**:
1. 检查网络连接
2. 重新获取Token并更新

### 错误3: "日期格式不正确"

**原因**: 日期格式错误
**解决**: 使用 `yyyy-MM-dd` 格式，如: `2025-01-15`

### 错误4: "导出失败"

**原因**: 权限或存储问题
**解决**:
1. 授予存储权限
2. 检查存储空间
3. 重启应用重试

---

## 数据说明

### Excel文件内容

**活动数据Excel**:
- Sheet1: 活动基本信息 (ID、名称、发起人、时间等)
- Sheet2: 活动统计 (总数、类型分布、参与人数)

**参与者统计Excel**:
- Sheet1: 参与者统计 (ID、昵称、参与次数、活动列表)
- Sheet2: 活动详情 (每个人的每次活动记录)
- Sheet3: 活动统计 (每个活动的参与情况)

**巡护/评测Excel**:
- Sheet1: 用户发帖统计 (发帖人、次数、时间、消息)
- Sheet2: 数据概览 (总人数、总次数、平均值等)

**综合统计Excel**:
- Sheet1: 综合次数统计 (姓名、各类次数、总次数)
- Sheet2: 统计摘要 (人数、平均值等)

---

## 最佳实践

1. **定期更新Token**: 建议每周检查一次Token是否有效

2. **使用WiFi**: 综合统计功能数据量大，建议使用WiFi网络

3. **分批导出**: 不要一次性导出太多数据，可以按月分批

4. **及时保存**: 导出的Excel文件及时保存到云盘或电脑

5. **数据备份**: 重要数据建议多处备份

---

**祝使用愉快！如有问题，请查阅其他文档。**
